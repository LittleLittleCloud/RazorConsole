@namespace RazorConsole.Components

@using Microsoft.AspNetCore.Components
@using RazorConsole.Components
@using RazorConsole.Gallery.Models
@using Spectre.Console

<Rows Gap="1" Alignment="Left" Expand="true">
    <Panel Title="Razor Component Output" TitleColor=@Color.LightSteelBlue1 BorderColor=@Color.Grey93>
        <Rows Gap="1">
            <RazorConsole.Components.Text Style="mediumspringgreen bold" Value="@GreetingTitle" />
            <RazorConsole.Components.Text Style="grey53" Value="@DateLabel" />
            <RazorConsole.Components.Text Style="grey53" Value="@TimestampMessage" />

            <Columns Spacing="4" Alignment="Center" Collapse="true">
                @if (HasTips)
                {
                    <Panel Title="Helpful Tips" TitleColor=@Color.BlueViolet BorderColor=@Color.BlueViolet Orientation="Vertical">
                        <Rows Gap="1">
                            @foreach (var tip in Model.Tips)
                            {
                                <RazorConsole.Components.Text Style="grey53 italic" Value="@tip" />
                            }
                        </Rows>
                    </Panel>
                }
                else
                {
                    <Panel Title="No Tips" TitleColor=@Color.Aqua BorderColor=@Color.Aqua>
                        <RazorConsole.Components.Text Style="grey53 italic" Value="No tips available yet." />
                    </Panel>
                }

                <Panel Title="Session Info" TitleColor=@Color.HotPink BorderColor=@Color.HotPink>
                    <Grid Columns="2" Spacing="2">
                        <RazorConsole.Components.Text Style="grey53 bold" Value="Name" />
                        <RazorConsole.Components.Text Style="grey53" Value="@DisplayName" />
                        <RazorConsole.Components.Text Style="grey53 bold" Value="Date" />
                        <RazorConsole.Components.Text Style="grey53" Value="@Model.Date.ToShortDateString()" />
                        <RazorConsole.Components.Text Style="grey53 bold" Value="Time" />
                        <RazorConsole.Components.Text Style="grey53" Value="@TimestampLabel" />
                    </Grid>
                </Panel>
            </Columns>

            <Spacer Lines="1" FillCharacter="-" />

            <Panel Title="Live Status" TitleColor=@Color.Gold1 BorderColor=@Color.Gold1 Orientation="Horizontal">
                <Spinner Message="Awaiting your input..." Style="yellow" SpinnerType="@SpinnerType" />
                <Spacer Lines="1" />
                <RazorConsole.Components.Text Style="italic" Value="Enter a name below to refresh the greeting." />
            </Panel>
        </Rows>
    </Panel>
</Rows>

@code {
    [Parameter]
    public required GreetingModel Model { get; set; }

    private string DisplayName => string.IsNullOrWhiteSpace(Model.Name) ? "Friend" : Model.Name;

    private string GreetingTitle => $"Hello, {DisplayName}!";

    private string DateLabel => Model.Date.ToString("dddd, MMMM d, yyyy");

    private string TimestampLabel => Model.Timestamp.ToString("HH:mm:ss");

    private string TimestampMessage => $"Now is {TimestampLabel}.";

    private bool HasTips => Model.Tips.Count > 0;

    private Spectre.Console.Spinner SpinnerType => Spectre.Console.Spinner.Known.Arc;
}